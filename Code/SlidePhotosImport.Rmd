---
title: "Oxygen_gradients"
output: html_notebook
---

# Introduction

This rmd. file imports oxygen data from Google sheet
Data is used to plot a oxygen gradient map of the winogradsky column 

#Loading Packages 

```{r loading packages}
library(tidyverse) 
library(googledrive) 
library(googlesheets4)
library(ggplot2)
library(knitr)
library(magick)
library(DT)
```
#Importing from google sheet

```{r load Slide_Photos direct from googlesheet}

googlesheets4::gs4_deauth()

Slide_Photos <- googlesheets4::read_sheet("https://docs.google.com/spreadsheets/d/1hNakCyqPsTNRFpf1lGjoBQ-papyZ6xHKT6mcvh3LMb8/edit?pli=1&gid=842906991#gid=842906991", "Slide_Photos") 
head(Slide_Photos)
```
```{r}
# Function to convert Google Drive shared link to direct URL
get_google_drive_direct_url <- function(drive_link) {
  # Extract the file ID from the Google Drive link
  file_id <- sub(".*d/(.*?)/.*", "\\1", drive_link)
  
  # Create the direct download URL
  DirectURL <- paste0("https://drive.google.com/uc?id=", file_id)
  
  return(DirectURL)
}

# Convert Google Drive links in the 'PhotoURL' column to direct URLs
Slide_Photos$DirectURL <- sapply(Slide_Photos$PhotoURL, get_google_drive_direct_url)

# View the updated data frame with direct URLs (only one 'DirectURL' column)
head(Slide_Photos)
```
```{r}
# Load necessary libraries
library(kableExtra)

# Assuming your 'Slide_Photos' already has the 'DirectURL' column with valid Google Drive direct URLs

# Function to generate image tags for use in kable
generate_image_tag <- function(url) {
  # Return the HTML <img> tag for the direct URL (adjust width/height as needed)
  return(paste0('<img src="', url, '" width="100px" height="100px" />'))
}

# Add the image tags to the data frame with the new column name 'Image'
Slide_Photos$Image <- sapply(Slide_Photos$DirectURL, generate_image_tag)

# Create a table using kable
Slide_Photos %>%
  select(Sample, Depth_cm, Image) %>%  # Select relevant columns (Image column now)
  kable("html", escape = FALSE) %>%  # escape = FALSE allows the HTML <img> tags to be rendered
  kable_styling(bootstrap_options = c("striped", "hover"))
```

`

